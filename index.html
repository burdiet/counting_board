
<html>
<head> 
<script type="text/javascript">
var cdNumber1 = -1;
var cdNumber2 = -1;
var timer1,timer2,countdown1,countdown2;
// idle=0, counting=1, pause=2, ready=3;
var tAstate = 0,tBstate = 0;
var scoreA = 0,scoreB = 0;

function convertIntView(number){ 
  if(number>=0 && number <10){
    return ("0"+number.toString());
  }else{
    return number.toString();
  }
}

function startCount(id,timer,cdNumber){
  if (id=='tA'){
    timer.style.backgroundColor = "yellow";
    timer.style.color = "#04060F";
    countdown1 = setInterval(function(){
      this.setCd(id,cdNumber);
      var mins = Math.floor(cdNumber / 60);
      var secs = Math.floor(cdNumber % 60);
      //console.log(mins , secs);
      timer.innerHTML = convertIntView(mins)+" : "+ convertIntView(secs);
      cdNumber--;
      if (cdNumber < 0) {
        clearInterval(countdown1);
      }
    },1000);
  }else if (id=='tB'){
    timer.style.backgroundColor = "yellow";
    timer.style.color = "#04060F";
    countdown2 = setInterval(function(){
      this.setCd(id,cdNumber);
      var mins = Math.floor(cdNumber / 60);
      var secs = Math.floor(cdNumber % 60);
      //console.log(mins , secs);
      timer.innerHTML = convertIntView(mins)+" : "+ convertIntView(secs);
      cdNumber--;
      if (cdNumber < 0) {
        clearInterval(countdown2);
      }
    },1000);    
  }
}

function getCountDownId(timer){
    if (timer=='tA'){
    return countdown1;
  }else if (timer=='tB'){
    return countdown2;
  }
}


function getCd(timer){
    if (timer=='tA'){
    return cdNumber1;
  }else if (timer=='tB'){
    return cdNumber2;
  }
}

function setCd(timer,number){
    if (timer=='tA'){
    cdNumber1 = number;
  }else if (timer=='tB'){
    cdNumber2 = number;
  }
}

function getState(timer){
  if (timer=='tA'){
    return tAstate;
  }else if (timer=='tB'){
    return tBstate;
  }
}

function setState(timer,state){
  if (timer=='tA'){
    tAstate = state;
  }else if (timer=='tB'){
    tBstate = state;
  }
}

function setTimer(e){
  var timerid = e.srcElement.id;
  timer = e.srcElement;
  timer_state = this.getState(timerid);
  switch(timer_state){
    case 0:
      do {
        var time = parseFloat(window.prompt("please enter time (minutes)","6"));
      } while(isNaN(time)&&time>0);
      this.setCd(timerid,time*60);
      var mins = Math.floor(time);
      var secs = Math.floor((time*60) % 60);
      //console.log(mins , secs);
      timer.innerHTML = convertIntView(mins)+" : "+ convertIntView(secs);
      this.setState(timerid,3);
      break;
    case 1:
      console.log('1');
      countdownid = this.getCountDownId(timerid);
      clearInterval(countdownid);
      //console.log(mins , secs);
      timer.style.backgroundColor = "#A79493";
      timer.style.color = "white";
      this.setState(timerid,2);
      break;
    case 2:
      console.log('2');
      this.setState(timerid,1);
      this.startCount(timerid,timer,this.getCd(timerid));
      break;
    case 3:
      this.setState(timerid,1);
      this.startCount(timerid,timer,this.getCd(timerid)); 
  }
}

function add(e){
  console.log(e.srcElement.id)
  if (e.srcElement.id=='left'){
    console.log('add')
    scoreA+=1;
    document.getElementById('lscore').innerHTML = scoreA;
  }else if(e.srcElement.id=='right'){
    scoreB+=1;
    document.getElementById('rscore').innerHTML = scoreB;
  }
}

function minus(e){
  if (e.srcElement.id=='left'&&scoreA>0){
    scoreA-=1;
    document.getElementById('lscore').innerHTML = scoreA;
  }else if(e.srcElement.id=='right'&&scoreB>0){
    scoreB-=1;
    document.getElementById('rscore').innerHTML = scoreB;
  }
}

</script>
<link rel="stylesheet" type="text/css" href="counting_board.css">
</head> 
<body>
  <div id='leftside'>
    <div id='name'>紅隊</div>
    <div id='box'>
      <div id="tA" class="boardbox" onclick="setTimer(event);" >00 : 00</div>
    </div>
    <div id='scorebox'>
      <div class='scorebar'>
        <img id='left' class='minus' src='minus.png' onclick="minus(event);"></img>
      </div>
      <div id='lscore' class='scorebar score'>0</div>
      <dissv class='scorebar'>
        <img id='left' class='add' src='add.png' onclick="add(event);"></img>
      </div>
    </div>
  </div>
  <div id='rightside'>
    <div id='name'>藍隊</div>
    <div id='box'>
      <div id="tB" class="boardbox" onclick="setTimer(event);" >00 : 00</div>
    </div>
    <div id='scorebox'>
      <div class='scorebar'>
        <img id='right' class='minus' src='minus.png' onclick="minus(event);"></img>
      </div>
      <div id='rscore' class='scorebar score'>0</div>
      <dissv class='scorebar'>
        <img id='right' class='add' src='add.png' onclick="add(event);"></img>
      </div>
  </div>
</body> 
</html>